!function(t){var e={};function n(i){if(e[i])return e[i].exports;var r=e[i]={i:i,l:!1,exports:{}};return t[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)n.d(i,r,function(e){return t[e]}.bind(null,r));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=0)}([function(t,e,n){"use strict";n.r(e);var i=function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.collidingCell=n,this.residingCell=e};function r(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var o=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.x=e,this.y=n}var e,n,i;return e=t,i=[{key:"fromString",value:function(e){var n=/\((-?\d+), (-?\d+)\)/.exec(e);return(!n||isNaN(parseInt(n[1],10))||isNaN(parseInt(n[2],10)))&&console.log({position:e}),new t(parseInt(n[1],10),parseInt(n[2],10))}}],(n=[{key:"topLeft",value:function(){return new t(this.x-1,this.y-1)}},{key:"top",value:function(){return new t(this.x,this.y-1)}},{key:"topRight",value:function(){return new t(this.x+1,this.y-1)}},{key:"left",value:function(){return new t(this.x-1,this.y)}},{key:"right",value:function(){return new t(this.x+1,this.y)}},{key:"bottomLeft",value:function(){return new t(this.x-1,this.y+1)}},{key:"bottom",value:function(){return new t(this.x,this.y+1)}},{key:"bottomRight",value:function(){return new t(this.x+1,this.y+1)}},{key:"neighbouringPositions",value:function(){return[this.topLeft(),this.top(),this.topRight(),this.left(),this.right(),this.bottomLeft(),this.bottom(),this.bottomRight()]}},{key:"toString",value:function(){return"(".concat(this.x,", ").concat(this.y,")")}}])&&r(e.prototype,n),i&&r(e,i),t}();function a(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function u(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var s=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.animated=!1,this.neighbours=[]}var e,n,i;return e=t,i=[{key:"dead",value:function(){return new t}},{key:"alive",value:function(){var e=new t;return e.animate(),e}}],(n=[{key:"tick",value:function(){return this.isAnimate()?this.tickWhenAnimate():this.tickWhenInanimate()}},{key:"tickWhenAnimate",value:function(){this.shouldDie()&&this.die()}},{key:"tickWhenInanimate",value:function(){this.shouldLive()&&this.animate()}},{key:"has3LiveNeighbours",value:function(){return 3===this.liveNeighbours.length}},{key:"isInanimate",value:function(){return!1===this.animated}},{key:"isAnimate",value:function(){return!0===this.animated}},{key:"animate",value:function(){this.animated=!0}},{key:"addNeighbours",value:function(t){this.neighbours=[].concat(a(this.neighbours),a(t))}},{key:"die",value:function(){this.animated=!1}},{key:"hasLessThan2LiveNeighbours",value:function(){return this.liveNeighbours.length<2}},{key:"hasMoreThan3LiveNeighbours",value:function(){return this.liveNeighbours.length>3}},{key:"shouldDie",value:function(){return this.hasLessThan2LiveNeighbours()||this.hasMoreThan3LiveNeighbours()}},{key:"shouldLive",value:function(){return this.has3LiveNeighbours()}},{key:"removeNeighbours",value:function(){this.neighbours=[]}},{key:"liveNeighbours",get:function(){return this.neighbours.filter(function(t){return t.isAnimate()})}}])&&u(e.prototype,n),i&&u(e,i),t}();var c=function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.topLeft=e,this.bottomRight=n};function f(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function l(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var h=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.grid=new Map,this.bottomRight=e}var e,n,r;return e=t,(n=[{key:"seed",value:function(t){var e=this;t.forEach(function(t){e.seedCell(t,e.emptyPositionInRange())}),console.log("seeded!")}},{key:"tick",value:function(){var t=this,e=new Map,n=new Set;this.boundaryPositions.forEach(function(t){return n.add(t.toString())}),this.liveCellPositions.flatMap(function(t){return[t].concat(f(t.neighbouringPositions()))}).forEach(function(t){return n.add(t.toString())}),n.forEach(function(n){var i=o.fromString(n);t.tickCell(i.x,i.y,e)}),this.grid=e}},{key:"tickCell",value:function(t,e,n){var i=new o(t,e),r=this.cellAt(i),a=new s;r.isAnimate()&&a.animate(),a.addNeighbours(this.neighboursOf(i)),a.tick(),a.removeNeighbours(),a.isAnimate()&&n.set(i.toString(),a)}},{key:"emptyPositionInRange",value:function(){var t;do{t=this.positionInRange()}while(this.grid.has(t.toString()));return t}},{key:"seedCell",value:function(t,e){var n=e.toString();if(this.grid.has(n))throw new i(this.grid.get(n),t);this.grid.set(n,t)}},{key:"cellAt",value:function(t){var e=t.toString();return this.grid.get(e)||s.dead()}},{key:"positionInRange",value:function(){var t=this.bottomRight.x/2,e=this.bottomRight.y/2,n=Math.floor(Math.random()*t)+Math.floor(t/2),i=Math.floor(Math.random()*e)+Math.floor(e/2);return new o(n,i)}},{key:"neighboursOf",value:function(t){var e=s.dead();return[this.grid.get(t.topLeft().toString())||e,this.grid.get(t.top().toString())||e,this.grid.get(t.topRight().toString())||e,this.grid.get(t.left().toString())||e,this.grid.get(t.right().toString())||e,this.grid.get(t.bottomLeft().toString())||e,this.grid.get(t.bottom().toString())||e,this.grid.get(t.bottomRight().toString())||e]}},{key:"cells",get:function(){return Array.from(this.grid.values())}},{key:"boundaryPositions",get:function(){for(var t=this.boundaries,e=[],n=t.topLeft.x;n<=t.bottomRight.x;n++)e.push(new o(n,t.topLeft.y),new o(n,t.bottomRight.y));for(var i=t.topLeft.y;i<=t.bottomRight.y;i++)e.push(new o(t.topLeft.x,i),new o(t.bottomRight.x,i));return e}},{key:"liveCellPositions",get:function(){return Array.from(this.grid.keys()).map(function(t){return o.fromString(t)})}},{key:"boundaries",get:function(){var t=Array.from(this.grid.keys(),function(t){return o.fromString(t)}),e=function(t,e){return Math.min(t,e)},n=function(t,e){return Math.max(t,e)},i=t.map(function(t){return t.y}).reduce(e),r=t.map(function(t){return t.x}).reduce(e),a=t.map(function(t){return t.y}).reduce(n),u=t.map(function(t){return t.x}).reduce(n);return new c(new o(r-1,i-1),new o(u+1,a+1))}}])&&l(e.prototype,n),r&&l(e,r),t}();function g(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function y(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var v=function(){function t(e,n,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.lastPrint=new Set,e.height=i*n,e.width=i*n,this.context=e.getContext("2d"),this.context.scale(i,i)}var e,n,i;return e=t,(n=[{key:"print",value:function(t){var e=this,n=g(t.grid.keys()),i=new Set(n.filter(function(t){return e.lastPrint.has(t)})),r=new Set(n.filter(function(t){return!i.has(t)})),o=g(this.lastPrint).filter(function(t){return!i.has(t)});this.render(r,"black"),this.render(o,"gray"),this.lastPrint=new Set(n)}},{key:"render",value:function(t,e){var n=this;this.context.fillStyle=e,Array.from(t,function(t){return o.fromString(t)}).forEach(function(t){return n.context.fillRect(t.x,t.y,1,1)})}}])&&y(e.prototype,n),i&&y(e,i),t}(),d=new o(199,199),m=new h(d);[new o(1,0),new o(2,1),new o(0,2),new o(1,2),new o(2,2)].forEach(function(t){return m.seedCell(s.alive(),t)}),m.seed(Array.from({length:2500},function(){return s.alive()}));var b=document.getElementById("the-canvas"),p=new c(new o(0,0),d);console.log(p);var w=new v(b,200,5);console.log({world:m,canvas:w,viewport:p}),w.print(m,p);var k=null;document.getElementById("start-btn").addEventListener("click",function(){!function t(){m.tick(),w.print(m,p),k=requestAnimationFrame(t)}()}),document.getElementById("stop-btn").addEventListener("click",function(){cancelAnimationFrame(k)}),document.getElementById("tick-btn").addEventListener("click",function(){m.tick(),w.print(m,p)})}]);
//# sourceMappingURL=main.js.map